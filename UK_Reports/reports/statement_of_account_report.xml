<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<template id="statement_of_account_body">
			<t t-set="doc_header_string" t-value="'Statement of Account'"/>
			<t t-call="UK_Reports.template_document_title"/>
			<div class="row">
				<div class="col-7">
					<strong>Statement To:</strong>
					<br/>
                    <span t-raw="o.contact_address.replace('\n\n', '\n').replace('\n', '&lt;br&gt;')"/>
				</div>
				<div class="col-5">
					<strong>Date</strong>
					<span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d-%m-%Y')"/>   
					<br/>
					<t t-if="o.ref">
						<strong>Customer Ref</strong>
						<span t-field="o.ref"/>
						<br/>
					</t>
					<t t-if="o.user_id">
						<strong>Account Manager</strong>
						<span t-field="o.user_id.name"/>
						<br/>
					</t>
					<strong>Currency</strong>
					<span t-field="o.company_id.currency_id.name"/>
				</div>
			</div>
			<br/>
			<br/>
			<div class="row">
				<t t-call="UK_Reports.payment_to_information"/>
			</div>
			<br/>

			<div class="row">
				<div class="col-12" id="statement-of-account-tandc-block">
					<span t-raw="o.company_id.statement_of_accounts_tandc"/>
				</div>
			</div>
			<table class="orderlines">
				<thead id="orderline-header" class="orderline-header">
					<tr>
						<th>Our Ref</th>
						<!-- This column is not being shown for the time being, as per NG -->
						<!-- <th class="text-right">Your Ref</th> -->
						<th>Transaction Date</th>
						<th>Due Date</th>
						<th>Narrative</th>
						<th class="text-right">Value</th>
						<th class="text-right">Overdue</th>
					</tr>
				</thead>
				<tbody>
					<tr t-foreach="o.statement_of_account_filtered_move_lines" t-as="line">
						<td t-esc="line.move_id.name"/>
						<!-- This column is not being shown for the time being, as per NG -->
						<!-- <td t-esc="line.ref"/> -->
						<td t-esc="line.date"/>
						<td t-esc="line.date_maturity"/>
						<td t-esc="line.name"/>
						<td t-esc="'%.2f'% line.statement_account_value" class="text-right"/>
						<td t-esc="'%.2f'% line.statement_account_overdue" class="text-right"/>
					</tr>
					<tr id="row-border-top-1" class="row-border-top">
						<td/>
						<td/>
						<td/>
						<td class="text-left bold">Totals</td>
						<td class="text-right" t-esc="'%.2f'% o.total_statement_account_value"/>
						<td class="text-right" t-esc="'%.2f'% o.total_statement_account_overdue"/>
					</tr>
				</tbody>
			</table>
		</template>


		<template id="uk_statement_of_account_document">
			<t t-call="UK_Reports.external_layout_uk">
				<div class="page">
					<t t-call="UK_Reports.statement_of_account_body"/>
				</div>
			</t>
		</template>

		<report
			id="uk_statement_of_account_print"
			model="res.partner"
			string="Statement of Account (UK format)"
			report_type="qweb-pdf"
			name="UK_Reports.uk_statement_of_account"
			file="UK_Reports.uk_statement_of_account"
			attachment="((object.name or '')+' Statement of Account '+'.pdf')"
		/>

		<template id="uk_statement_of_account">
			<t t-call="web.html_container">
				<t t-foreach="docs" t-as="o">
					<t t-call="UK_Reports.uk_statement_of_account_document" t-lang="user.partner_id.lang"/>
				</t>
			</t>
		</template>
	</data>
</odoo>
